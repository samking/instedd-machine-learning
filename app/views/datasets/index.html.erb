<h1>Listing datasets for user: <%= current_user.login %> (id: <%= current_user.id %>)</h1>

<table>
  <tr>
    <th>Your Tables</th>
  </tr>
  <tr>
    <% ["Table Name", "Table ID", "Table Owner Name","Table Owner User ID", "Show", "Destroy"].each do |header| %>
      <td><strong><%= header %></strong></td>
    <% end %>
  </tr>

<% @datasets.each do |dataset| %>
  <tr>
    <td><%= dataset.name %></td>
    <td><%= dataset.table_uuid %></td>
    <td><%= User.find(dataset.user_id).login %></td>
    <td><%= dataset.user_id %></td>
    <td><%= link_to 'Show', dataset %></td>
    <td><%= link_to 'Destroy', dataset, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<% if current_user.is_admin? %>
  <h2>Tables in Remote Database</h2>
  <p><%= DatabaseInterface.list_tables.inspect %></p>

  <p><%= form_tag(cleanup_datasets_path, :method => "delete") %>
    Client UUID That Needs Its Tables Deleted <%= text_field_tag 'table_to_remove' %>
    <%= submit_tag 'Delete' %>
  </p>
<% end %>

<br />
<%= link_to 'New dataset', new_dataset_path %>
